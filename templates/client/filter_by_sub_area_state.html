 {% extends 'client/base.html' %} {% load calculate_experience %} {% block body_block %}

<div class='container' style='margin-top:3%;'>

    <header style='margin-left:-2.3%'>
        <h1 class="u-margin-top-0"><span id="lawyer-serp-title">   {% if sub_area == 'all' %} {{lawyer_state}} {{pname }} {% else %} {{lawyer_state }} {{sub_area}}{% endif %} Lawyers</span></h1>
        <p class="text-muted">
        {% if sub_area == 'all' %}
            Compare {{pname}} lawyers near you. Read reviews and contact them directly.</p>
        {% else %}
            Compare {{sub_area}} lawyers near you. Read reviews and contact them directly.</p>

        {% endif %}
        
    </header>
    <div class="row margin-lawyer-top" id='myTable1'>
        <div class="col-xs-12 col-md-4">
            <div class='row' style='margin-top:10%;'>
                <div class='col-xs-6'>

                    <section>
                      <form name='form' method='GET' action='{% url "filter_by_sub_area_state" %}'>
                         <input type='hidden' type='text' name='practice_area' value='{{pname}}'/>
                         <input type='hidden' type='text' name='state' value='{{state}}'/>
                        <label>Select Sub Practice Area </label>
                        <select name='sub_area' class='form-control' id='show_area'  onchange="this.form.submit()">
                        
                                <option value='all'>--ALL--</option>
                                {% if sub_area != 'all' %}
                                     <option value='{{sub_area}}' selected='selected'>{{sub_area}}</option>
                                    
                                     {% for p in sub_practice_area %}
                                            {% if p.practice_type != sub_area %}
                                                <option value='{{p.practice_type}}'>{{p.practice_type}}</option>
                                                {% endif %}
                                           
                                     {% endfor %}
                                    
                                         {% else %}
                                     {% for p in sub_practice_area %}
                                            <option value='{{p.practice_type}}'>{{p.practice_type}}</option>
                                     {% endfor %}
                                {% endif %}
                            </select>
                          
                              </form>
                    </section>
                </div>

            </div>
            <div class='row' style='margin-top:10%;'>
                <div class='col-xs-6'>
                    <section>
                        <form name='form' method='GET' id='' action='{% url "filter_by_rating_state" %}'>
                        
                            <input type='hidden' type='text' name='practice_area' value='{{pname}}' />
                            <input type='hidden' type='text' name='state' value='{{state}}' />
                        <label>REVIEW</label>

                        <div class='rating-stars' style='margin-left:-11%;'>
                            <ul id='stars'>
                                {% if rating == '5' %}
                                    <li><input type="radio" class="form-check-input" name="rating" id='' value='5' onclick="this.form.submit()" checked></li>
                                {% else %}
                                    <li><input type="radio" class="form-check-input" name="rating" id='' value='5' onclick="this.form.submit()"></li>
                                {% endif %}
                                <li class='star' title='Poor' data-value='1' value='Poor'> <i class='fa fa-star fa-fw'></i></li>
                                <li class='star' title='Fair' data-value='2'> <i class='fa fa-star fa-fw'></i></li>
                                <li class='star' title='Good' data-value='3'> <i class='fa fa-star fa-fw'></i> </li>
                                <li class='star' title='Excellent' data-value='4'> <i class='fa fa-star fa-fw'></i> </li>
                                <li class='star' title='WOW!!!' data-value='5'> <i class='fa fa-star fa-fw'></i> </li>
                            </ul>
                        </div>
                        <div class='rating-stars' style='margin-left:-11%;'>
                            <ul id='stars'>
                                 {% if rating == '4' %}
                                    <li><input type="radio" class="form-check-input" name="rating" id='' value='4' onclick="this.form.submit()" checked></li>
                                {% else %}
                                    <li><input type="radio" class="form-check-input" name="rating" id='' value='4' onclick="this.form.submit()"></li>
                                {% endif %}
                                <li class='star' title='Poor' data-value='1' value='Poor'> <i class='fa fa-star fa-fw'></i></li>
                                <li class='star' title='Fair' data-value='2'> <i class='fa fa-star fa-fw'></i></li>
                                <li class='star' title='Good' data-value='3'> <i class='fa fa-star fa-fw'></i> </li>
                                <li class='star' title='Excellent' data-value='4'> <i class='fa fa-star fa-fw'></i> </li>
                                <li class='star' title='WOW!!!' data-value='5'> <i class='fa fa-star fa-fw' style='color: black;'></i> </li>
                                 <li class='star'>& More</i> </li>
                            </ul>
                        </div>
                        <div class='rating-stars' style='margin-left:-11%;'>
                            <ul id='stars'>
                                 {% if rating == '3' %}
                                    <li><input type="radio" class="form-check-input" name="rating" id='' value='3' onclick="this.form.submit()" checked></li>
                                {% else %}
                                    <li><input type="radio" class="form-check-input" name="rating" id='' value='3' onclick="this.form.submit()"></li>
                                {% endif %}
                                <li class='star' title='Poor' data-value='1' value='Poor'> <i class='fa fa-star fa-fw'></i></li>
                                <li class='star' title='Fair' data-value='2'> <i class='fa fa-star fa-fw'></i></li>
                                <li class='star' title='Good' data-value='3'> <i class='fa fa-star fa-fw'></i> </li>
                                <li class='star' title='Excellent' data-value='4'> <i class='fa fa-star fa-fw' style='color: black;'></i> </li>
                                <li class='star' title='WOW!!!' data-value='5'> <i class='fa fa-star fa-fw' style='color: black;'></i> </li>
                                 <li class='star'>& More</i> </li>
                            </ul>
                        </div>
                        <div class='rating-stars' style='margin-left:-11%;'>
                            <ul id='stars'>
                                 {% if rating == '2' %}
                                    <li><input type="radio" class="form-check-input" name="rating" id='' value='2' onclick="this.form.submit()" checked></li>
                                {% else %}
                                    <li><input type="radio" class="form-check-input" name="rating" id='' value='2' onclick="this.form.submit()"></li>
                                {% endif %}
                                <li class='star' title='Poor' data-value='1' value='Poor'> <i class='fa fa-star fa-fw'></i></li>
                                <li class='star' title='Fair' data-value='2'> <i class='fa fa-star fa-fw'></i></li>
                                <li class='star' title='Good' data-value='3'> <i class='fa fa-star fa-fw' style='color: black;'></i> </li>
                                <li class='star' title='Excellent' data-value='4'> <i class='fa fa-star fa-fw' style='color: black;'></i> </li>
                                <li class='star' title='WOW!!!' data-value='5'> <i class='fa fa-star fa-fw' style='color: black;'></i> </li>
                                 <li class='star'>& More</i> </li>
                            </ul>
                        </div>
                        <div class='rating-stars' style='margin-left:-11%;'>
                            <ul id='stars'>
                                 {% if rating == '1' %}
                                    <li><input type="radio" class="form-check-input" name="rating" id='' value='1' onclick="this.form.submit()" checked></li>
                                {% else %}
                                    <li><input type="radio" class="form-check-input" name="rating" id='' value='1' onclick="this.form.submit()"></li>
                                {% endif %}
                                <li class='star' title='Poor' data-value='1' value='Poor'> <i class='fa fa-star fa-fw'></i></li>
                                <li class='star' title='Fair' data-value='2'> <i class='fa fa-star fa-fw' style='color: black;'></i></li>
                                <li class='star' title='Good' data-value='3'> <i class='fa fa-star fa-fw' style='color: black;'></i> </li>
                                <li class='star' title='Excellent' data-value='4'> <i class='fa fa-star fa-fw' style='color: black;'></i> </li>
                                <li class='star' title='WOW!!!' data-value='5'> <i class='fa fa-star fa-fw' style='color: black;'></i> </li>
                                 <li class='star'>& More</i> </li>
                            </ul>
                        </div>
                    </form>
                    </section>

                </div>

            </div>




            <div class='row' style='margin-top:10%;'>
                <div class='col-xs-6'>

                    <section>
                        <form name='form' method='GET' id='' action="{% url 'filter_by_experience_state' %}">
                        <label>EXPERIENCE
                        </label>
                         <input type='hidden' type='text' name='practice_area' value='{{pname}}'/>
                         <input type='hidden' type='text' name='state' value='{{state}}'/>
                        <div class='rating-stars' style='margin-left:-18%;font-size:15px;'>
                            <ul id='stars'>
                              
                                <li> <input type="radio" class="form-check-input" name="range" id='rating' value='>20' onclick="this.form.submit()">20+YEARS</li>
                               
                            </ul>
                            <ul id='stars'>
                                
                                <li> <input type="radio" class="form-check-input" name="range" id='rating' value='10-20' onclick="this.form.submit()">10-20 YEARS</li>
                               
                            </ul>
                            <ul id='stars'>
                               
                                <li> <input type="radio" class="form-check-input" name="range" id='rating' value='5-10' onclick="this.form.submit()">5-10 YEARS</li>
                                
                            </ul>
                            <ul id='stars'>
                                
                                <li> <input type="radio" class="form-check-input" name="range" id='rating' value='0-5' onclick="this.form.submit()">0-5 YEARS</li>
                              
                            </ul>
                        </div>
                    </form>
                    </section>
                </div>

            </div>
        </div>
        <div class="col-xs-12 col-md-8">
        {% if state_wise_lawyer %}
            {% for s in state_wise_lawyer %}
               
            <div class="row" style='margin-top:5%;'>
                <div class="col-xs-3 col-sm-2 remove-right-gutter">
                    <div class="labeled-img u-font-size-xs">

                        <img class="img-responsive-lawyer loaded" src="{{ MEDIA_URL }}/{{s.lawyer_id.profile_image}}">
                    </div>

                </div>
                <div class="col-xs-9 col-sm-10">
                    <div class="row">
                        <div class="col-xs-12 col-md-8">
                            <a href=''>
                                <h3 class="u-vertical-margin-0 lawyer-text">{{s.lawyer_id.user.first_name}} {{s.lawyer_id.user.last_name}}</h3>
                            </a>

                            <div class="row lawyer-row">
                                <div class="col-xs-6">
                                    <div class="u-margin-bottom-0 u-font-size-small">
                                        <p class="visible-xs">
                                            <span class="u-text-color-yellow">
                                                    <div class='rating-stars'  style='margin-left:-11%;margin-top:-9%;'>
                                              
                                                            <ul id='stars'>
                                                             
                                                               <li class='star' title='Poor' data-value='1' value='Poor'>
                                                                    <i class='fa fa-star fa-fw'></i>
                                                                </li>
                                                                <li class='star' title='Fair' data-value='2'>
                                                                    <i class='fa fa-star fa-fw'></i>
                                                                </li>
                                                                <li class='star' title='Good' data-value='3'>
                                                                    <i class='fa fa-star fa-fw'></i>
                                                                </li>
                                                                <li class='star' title='Excellent' data-value='4'>
                                                                    <i class='fa fa-star fa-fw'></i>
                                                                </li>
                                                                <li class='star' title='WOW!!!' data-value='5'>
                                                                    <i class='fa fa-star fa-fw'></i>
                                                                </li> 
                                                                <li class='star'>
                                                                        {% for c in review_count %}
                                                                       
                                                                        {% if s.lawyer_id.user_id == c.lawyer_id__user_id%}
                                                                            {{c.dcount}}<small> reviews</small>
                                                                        {% endif %}
                                                                        {% endfor %}
                                                                </li> 
                                                            </ul>
                                                        </div>
                                            </p>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-xs-12 remove-right-gutter">
                                    <div class="row lawyer-row">
                                        <div class="col-xs-12 hidden-xs hidden-sm remove-right-gutter v-js-serp-lawyer-licensed">
                                            <i class="svg-inline--fa fa fa-university fa-w-16 u-text-color-dark-gray"></i>
                                            <span class="small text-muted-lawyer"> {{ s.lawyer_id.year_admitted|experience }} years licensed</span></div>
                                </div>
                            </div>
                            <div class="col-xs-12 remove-right-gutter">
                                <div class="row lawyer-row">
                                    <div class="col-xs-12 hidden-xs hidden-sm remove-right-gutter">
                                        <h3 class="u-vertical-margin-0 lawyer-email">{{ s.lawyer_id.user.email}}</h3>
                                    </div>
                                </div>
                            </div>
                             <div class="col-xs-12 remove-right-gutter">
                                <div class="row lawyer-row">
                                    <div class="col-xs-12 hidden-xs hidden-sm remove-right-gutter">
                                        <h3 class="u-vertical-margin-0 lawyer-email">{{ s.lawyer_id.state}}</h3>
                                    </div>
                                </div>
                            </div>
                            <div class="col-xs-12 remove-right-gutter">
                                <div class="row lawyer-row">
                                    <div class="col-xs-12 hidden-xs hidden-sm remove-right-gutter">
                                        <h3 class="u-vertical-margin-0 lawyer-email">{{ s.practice_area.practice }}</h3>
                                    </div>
                                </div>
                            </div>
                            <div class="col-xs-12 remove-right-gutter">
                                <div class="row lawyer-row">
                                    <div class="col-xs-12 hidden-xs hidden-sm remove-right-gutter">
                                        <h3 class="u-vertical-margin-0 lawyer-email"><i class="fa fa-map-marker marker-icon-css"></i>{{ s.lawyer_id.address1 }}</h3>
                                    </div>
                                </div>
                            </div>
                            <div class="col-xs-12 remove-right-gutter">
                                <div class="row lawyer-row">

                                    <div class="col-xs-12 hidden-xs hidden-sm remove-right-gutter">
                                        <div style='max-height: 83px;overflow:hidden;'>

                                        </div>
                                    </div>

                                </div>
                            </div>
                        </div>


                        <div class="col-xs-12 col-md-4 v-optimizely-card hidden-xs hidden-sm v-js-serp-lawyer-ctas" data-gtm-vis-first-on-screen-223405_568="6829" data-gtm-vis-total-visible-time-223405_568="100" data-gtm-vis-has-fired-223405_568="1">

                            <div class="row small text-center">
                                <div class="col-sm-12 u-margin-top-half">
                                    <div class="u-spacer-half"></div><a rel="nofollow" class="btn-message btn-outline-review" style='text-decoration: none;width: 94%;border-radius: 5px;' href="{% url 'lawyer_profile' s.lawyer_id.user.id %}">View Profile</a></div>
                            </div>
                            <div class="row small text-center">
                                <div class="col-sm-12 u-margin-top-half">
                                    <div class="u-spacer-half"></div><a rel="nofollow" class="btn-review btn-outline-review" style='text-decoration: none;width: 94%;' href="{% url 'viewall_review_lawyer' s.lawyer_id.user.id %}">View All Reviews</a></div>
                            </div>
                               {% if user.is_authenticated and user.is_staff %}
                             <div class="row small text-center">
                                <div class="col-sm-12 u-margin-top-half">
                                    <div class="u-spacer-half"></div><a rel="nofollow" data-id="{{ s.lawyer_id.user.id }}" class="btn-message btn-outline-review message_button" data-toggle="modal" data-target="#myModal1" data-whatever="@getbootstrap" style='background-color: #0040ff;text-decoration: none;width: 94%;border-radius: 5px;'
                                        href="">Write Message</a></div>

                            </div>
                            {% endif %}
                        </div>
                    </div>

                </div>
            </div>
            <hr/> {% endfor %}
            <ul class="pagination">

                {% if state_wise_lawyer.has_previous %}
                <li class="page-item"><a class="page-link" href="?practice_area={{pname}}&page={{ state_wise_lawyer.previous_page_number }}">&laquo;</a></li>
                {% else %}
                <li class="page-item disabled"><span class="page-link">&laquo;</span></li>
                {% endif %} {% for i in state_wise_lawyer.paginator.page_range %} {% if state_wise_lawyer.number == i %}
                <li class="page-item active"><span class="page-link">{{ i }} <span class="sr-only">(current)</span></span>
                </li>
                {% else %}
                <li class="page-item"><a class="page-link" href="?state_wise_lawyer={{pname}}&page={{ i }}">{{ i }}</a></li>
                {% endif %} {% endfor %} {% if data.has_next %}
                <li class="page-item"><a class="page-link" href="?state_wise_lawyer={{pname}}&page={{ state_wise_lawyer.next_page_number }}">&raquo;</a></li>
                {% else %}
                <li class="page-item disabled"><span class="page-link">&raquo;</span></li>
                {% endif %}
            </ul>
            {% else %}
            <div class='container' style='margin-top:3%'>
                <div class="alert alert-danger">
                <strong>Oooop's!</strong> No Lawyers available...
                </div>
                </div>
            {% endif %}

        </div>
       
       
        
        </ul>
    </div>
</div>



</div>

<div class="modal fade" id="myModal1" tabindex="-1" role="dialog" aria-labelledby="myModal1" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">Message {{p.lawyer_id.user.first_name}}</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
                </button>
                </div>
                <div class="modal-body">
                    <form>

                        <div class="form-group">
                            <label for="message-text" class="col-form-label">Message:</label>
                            <textarea class="form-control" id="message-text">{{p.lawyer_id.user.id}}</textarea>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary">Send message</button>
                </div>
            </div>
        </div>
    </div>
</div>
</div>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<script>
    $('.message_button').click(function() {
        var user_id;
        user_id = $(this).attr("data-id");


        $.ajax({
            type: 'GET',
            url: '/send_messages/',
            data: {
                'user_id': user_id
            },
            success: function(data) {
                $('#myModal1').html(data);
            }

        })
    });
</script>

{% endblock %}