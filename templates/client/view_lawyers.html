 {% extends 'client/base.html' %} {% block body_block %} {% load calculate_experience %}

<!-- START -->
<div class='container' style='margin-top:3%;'>
<h3>This is main view_lawyer page</h3>
    <header style='margin-left:-2.3%'>
    {% if sub_area %}
         <h1 class="u-margin-top-0"><span id="lawyer-serp-title"> {{lawyer_state}} {% if sub_area == 'all' %}{{pname}}{% else %}{{sub_area}}{% endif %}  Lawyers</span></h1>
        <p class="text-muted">Compare {{lawyer_state}} {% if sub_area == 'all' %}{{pname}}{% else %}{{sub_area}}{% endif %} lawyers near you. Read reviews and contact them directly.</p>
    {% else %}

        <h1 class="u-margin-top-0"><span id="lawyer-serp-title">{{lawyer_state}} {{pname}} Lawyers</span></h1>
        <p class="text-muted">Compare {{lawyer_state}} {{pname}} lawyers near you. Read reviews and contact them directly.</p>
    {% endif %}
    </header>
    <div class="row margin-lawyer-top">
        <div class="col-xs-12 col-md-4">
            <div class='row' style='margin-top:10%;'>
                <div class='col-xs-6'>

                    <section>
                    {% if lawyer_state %}
                         <form name='form' method='GET' action='{% url "filter_by_sub_area_state" %}'>
                          <input type='hidden' type='text' name='state' value='{{state}}'/>
                    {% else %}
                        <form name='form' method='GET' action='{% url "filter_by_sub_area" %}'>
                    {% endif %}

                            <input type='hidden' type='text' name='practice_area' value='{{pname}}' />
                            <label>Select Sub Practice Area</label>
                            <select name='sub_area' class='form-control' id='show_area' onchange="this.form.submit()">
                            <option value='all'>--ALL--</option>
                            {% if sub_area %}
                                 <option value='{{sub_area}}' selected='selected'>{{sub_area}}</option>
                                 {% for p in sub_practice_area %}
                                        {% if p.practice_type != sub_area %}
                                            <option value='{{p.practice_type}}'>{{p.practice_type}}</option>
                                        {% endif %}
                                 {% endfor %}
                            {% else %}
                                 {% for p in sub_practice_area %}
                                        <option value='{{p.practice_type}}'>{{p.practice_type}}</option>
                                 {% endfor %}
                            {% endif %}
                        </select>
                        </form>
                    </section>
                </div>

            </div>
            <div class='row' style='margin-top:10%;'>
                <div class='col-xs-6'>
                    <section>
                    {% if lawyer_state %}
                         <form name='form' method='GET' action='{% url "filter_by_rating_state" %}'>
                          <input type='hidden' type='text' name='state' value='{{state}}'/>
                    {% else %}
                        <form name='form' method='GET' id='' action='{% url "filter_by_rating" %}'>
                    {% endif %}
                            <input type='hidden' type='text' name='practice_area' value='{{pname}}' />
                            <label>REVIEW</label>

                            <div class='rating-stars' style='margin-left:-11%;'>
                            <ul id='stars'>
                                {% if rating == '5' %}
                                    <li><input type="radio" class="form-check-input" name="rating" id='' value='5' onclick="this.form.submit()" checked></li>
                                {% else %}
                                    <li><input type="radio" class="form-check-input" name="rating" id='' value='5' onclick="this.form.submit()"></li>
                                {% endif %}
                                <li class='star' title='Poor' data-value='1' value='Poor'> <i class='fa fa-star fa-fw'></i></li>
                                <li class='star' title='Fair' data-value='2'> <i class='fa fa-star fa-fw'></i></li>
                                <li class='star' title='Good' data-value='3'> <i class='fa fa-star fa-fw'></i> </li>
                                <li class='star' title='Excellent' data-value='4'> <i class='fa fa-star fa-fw'></i> </li>
                                <li class='star' title='WOW!!!' data-value='5'> <i class='fa fa-star fa-fw'></i> </li>
                            </ul>
                        </div>
                        <div class='rating-stars' style='margin-left:-11%;'>
                            <ul id='stars'>
                                 {% if rating == '4' %}
                                    <li><input type="radio" class="form-check-input" name="rating" id='' value='4' onclick="this.form.submit()" checked></li>
                                {% else %}
                                    <li><input type="radio" class="form-check-input" name="rating" id='' value='4' onclick="this.form.submit()"></li>
                                {% endif %}
                                <li class='star' title='Poor' data-value='1' value='Poor'> <i class='fa fa-star fa-fw'></i></li>
                                <li class='star' title='Fair' data-value='2'> <i class='fa fa-star fa-fw'></i></li>
                                <li class='star' title='Good' data-value='3'> <i class='fa fa-star fa-fw'></i> </li>
                                <li class='star' title='Excellent' data-value='4'> <i class='fa fa-star fa-fw'></i> </li>
                                <li class='star' title='WOW!!!' data-value='5'> <i class='fa fa-star fa-fw' style='color: black;'></i> </li>
                                 <li class='star'>& More</i> </li>
                            </ul>
                        </div>
                        <div class='rating-stars' style='margin-left:-11%;'>
                            <ul id='stars'>
                                 {% if rating == '3' %}
                                    <li><input type="radio" class="form-check-input" name="rating" id='' value='3' onclick="this.form.submit()" checked></li>
                                {% else %}
                                    <li><input type="radio" class="form-check-input" name="rating" id='' value='3' onclick="this.form.submit()"></li>
                                {% endif %}
                                <li class='star' title='Poor' data-value='1' value='Poor'> <i class='fa fa-star fa-fw'></i></li>
                                <li class='star' title='Fair' data-value='2'> <i class='fa fa-star fa-fw'></i></li>
                                <li class='star' title='Good' data-value='3'> <i class='fa fa-star fa-fw'></i> </li>
                                <li class='star' title='Excellent' data-value='4'> <i class='fa fa-star fa-fw' style='color: black;'></i> </li>
                                <li class='star' title='WOW!!!' data-value='5'> <i class='fa fa-star fa-fw' style='color: black;'></i> </li>
                                 <li class='star'>& More</i> </li>
                            </ul>
                        </div>
                        <div class='rating-stars' style='margin-left:-11%;'>
                            <ul id='stars'>
                                 {% if rating == '2' %}
                                    <li><input type="radio" class="form-check-input" name="rating" id='' value='2' onclick="this.form.submit()" checked></li>
                                {% else %}
                                    <li><input type="radio" class="form-check-input" name="rating" id='' value='2' onclick="this.form.submit()"></li>
                                {% endif %}
                                <li class='star' title='Poor' data-value='1' value='Poor'> <i class='fa fa-star fa-fw'></i></li>
                                <li class='star' title='Fair' data-value='2'> <i class='fa fa-star fa-fw'></i></li>
                                <li class='star' title='Good' data-value='3'> <i class='fa fa-star fa-fw' style='color: black;'></i> </li>
                                <li class='star' title='Excellent' data-value='4'> <i class='fa fa-star fa-fw' style='color: black;'></i> </li>
                                <li class='star' title='WOW!!!' data-value='5'> <i class='fa fa-star fa-fw' style='color: black;'></i> </li>
                                 <li class='star'>& More</i> </li>
                            </ul>
                        </div>
                        <div class='rating-stars' style='margin-left:-11%;'>
                            <ul id='stars'>
                                 {% if rating == '1' %}
                                    <li><input type="radio" class="form-check-input" name="rating" id='' value='1' onclick="this.form.submit()" checked></li>
                                {% else %}
                                    <li><input type="radio" class="form-check-input" name="rating" id='' value='1' onclick="this.form.submit()"></li>
                                {% endif %}
                                <li class='star' title='Poor' data-value='1' value='Poor'> <i class='fa fa-star fa-fw'></i></li>
                                <li class='star' title='Fair' data-value='2'> <i class='fa fa-star fa-fw' style='color: black;'></i></li>
                                <li class='star' title='Good' data-value='3'> <i class='fa fa-star fa-fw' style='color: black;'></i> </li>
                                <li class='star' title='Excellent' data-value='4'> <i class='fa fa-star fa-fw' style='color: black;'></i> </li>
                                <li class='star' title='WOW!!!' data-value='5'> <i class='fa fa-star fa-fw' style='color: black;'></i> </li>
                                 <li class='star'>& More</i> </li>
                            </ul>
                        </div>
                        </form>
                    </section>

                </div>

            </div>



            <div class='row' style='margin-top:10%;'>
                <div class='col-xs-6'>

                    <section>
                     {% if lawyer_state %}
                         <form name='form' method='GET' action='{% url "filter_by_experience_state" %}'>
                          <input type='hidden' type='text' name='state' value='{{state}}'/>
                    {% else %}
                        <form name='form' method='GET' id='' action='{% url "filter_by_experience" %}'>
                    {% endif %}
                            <label>EXPERIENCE
                        </label>
                            <input type='hidden' type='text' name='practice_area' value='{{pname}}' />
                            <div class='rating-stars' style='margin-left:-18%;font-size:15px;'>
                                <ul id='stars'>
                                    {% if experience_id == '>20' %}
                                    <li> <input type="radio" class="form-check-input" name="range" id='rating' value='>20' onclick="this.form.submit()" checked>20+YEARS</li>
                                    {% else %}
                                    <li> <input type="radio" class="form-check-input" name="range" id='rating' value='>20' onclick="this.form.submit()">20+YEARS</li>

                                    {% endif %}
                                </ul>
                                <ul id='stars'>
                                    {% if experience_id == '10-20' %}
                                    <li> <input type="radio" class="form-check-input" name="range" id='rating' value='10-20' onclick="this.form.submit()" checked>10-20 YEARS</li>
                                    {% else %}
                                    <li> <input type="radio" class="form-check-input" name="range" id='rating' value='10-20' onclick="this.form.submit()">10-20 YEARS</li>
                                    {% endif %}
                                </ul>
                                <ul id='stars'>
                                    {% if experience_id == '5-10' %}
                                    <li> <input type="radio" class="form-check-input" name="range" id='rating' value='5-10' onclick="this.form.submit()" checked>5-10 YEARS</li>
                                    {% else %}
                                    <li> <input type="radio" class="form-check-input" name="range" id='rating' value='5-10' onclick="this.form.submit()">5-10 YEARS</li>
                                    {% endif %}
                                </ul>
                                <ul id='stars'>
                                    {% if experience_id == '0-5' %}
                                    <li> <input type="radio" class="form-check-input" name="range" id='rating' value='0-5' onclick="this.form.submit()" checked>0-5 YEARS</li>
                                    {% else %}
                                    <li> <input type="radio" class="form-check-input" name="range" id='rating' value='0-5' onclick="this.form.submit()">0-5 YEARS</li>
                                    {% endif %}
                                </ul>
                            </div>
                        </form>
                    </section>
                </div>

            </div>
        </div>
        <div class="col-xs-12 col-md-8">
            {% if lawyer %} {% for p in lawyer %}

            <div class="row" style='margin-top:5%;'>
                <div class="col-xs-3 col-sm-2 remove-right-gutter">
                    <div class="labeled-img u-font-size-xs">

                        <img class="img-responsive-lawyer loaded" src="{{ MEDIA_URL }}/{{p.lawyer_id.profile_image}}">
                    </div>

                </div>
                <div class="col-xs-9 col-sm-10">
                    <div class="row">
                        <div class="col-xs-12 col-md-8">
                            <a href='{% url "lawyer_profile" p.lawyer_id.user.id %}'>
                                <h3 class="u-vertical-margin-0 lawyer-text">{{p.lawyer_id.user.first_name}} {{p.lawyer_id.user.last_name}}</h3>
                            </a>
                            <div class="row lawyer-row">
                                <div class="col-xs-6">
                                    <div class="u-margin-bottom-0 u-font-size-small">
                                        <p class="visible-xs">
                                            <span class="u-text-color-yellow">
                                                    <div class='rating-stars'  style='margin-left:-11%;margin-top:-9%;'>
                                              
                                                            <ul id='stars'>
                                                           
                                                                {% if rating %}
                                                                
                                                                  <li class='star'>
                                                                    {% for i in "x"|rjust:p.rating %}
                                                                        <li class='star'>
                                                                            <i class='star fa fa-star fa-fw'></i>
                                                                        </li>
                                                                    {% endfor %} 
                                                                    </li>
                                                                {% else %}  
                                                                    <li class='star' title='Poor' data-value='1' value='Poor'>
                                                                    <i class='fa fa-star fa-fw'></i>
                                                                </li>
                                                                <li class='star' title='Fair' data-value='2'>
                                                                    <i class='fa fa-star fa-fw'></i>
                                                                </li>
                                                                <li class='star' title='Good' data-value='3'>
                                                                    <i class='fa fa-star fa-fw'></i>
                                                                </li>
                                                                <li class='star' title='Excellent' data-value='4'>
                                                                    <i class='fa fa-star fa-fw'></i>
                                                                </li>
                                                                <li class='star' title='WOW!!!' data-value='5'>
                                                                    <i class='fa fa-star fa-fw'></i>
                                                                </li> 
                                                                {% endif %}
                                                               
                                                                <li class='star'>
                                                                        {% for c in review_count %}
                                                                       
                                                                        {% if p.lawyer_id.user_id == c.lawyer_id__user_id%}
                                                                            <small>total {{c.dcount}} reviews</small>
                                                                        {% endif %}
                                                                        {% endfor %}
                                                                </li> 
                                                            </ul>
                                                        </div>
                                            </p>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-xs-12 remove-right-gutter">
                                    <div class="row lawyer-row">
                                        <div class="col-xs-12 hidden-xs hidden-sm remove-right-gutter v-js-serp-lawyer-licensed">
                                            <i class="svg-inline--fa fa fa-university fa-w-16 u-text-color-dark-gray"></i>
                                            <span class="small text-muted-lawyer"> {{ p.lawyer_id.year_admitted|experience }} years licensed</span></div>
                                </div>
                            </div>
                            
                            <div class="col-xs-12 remove-right-gutter">
                                <div class="row lawyer-row">
                                    <div class="col-xs-12 hidden-xs hidden-sm remove-right-gutter">
                                        <h3 class="u-vertical-margin-0 lawyer-email">{{ p.lawyer_id.state}}</h3>
                                    </div>
                                </div>
                            </div>
                            <div class="col-xs-12 remove-right-gutter">
                                <div class="row lawyer-row">
                                    <div class="col-xs-12 hidden-xs hidden-sm remove-right-gutter">
                                    {% if pname %}
                                         <h3 class="u-vertical-margin-0 lawyer-email">{{ pname }}</h3>
                                    {% else %}
                                        <h3 class="u-vertical-margin-0 lawyer-email">{{ p.practice_area.practice }}</h3>
                                    {% endif %}
                                    </div>
                                </div>
                            </div>

                            <div class="col-xs-12 remove-right-gutter">
                                <div class="row lawyer-row">
                                    <div class="col-xs-12 hidden-xs hidden-sm remove-right-gutter">
                                        <h3 class="u-vertical-margin-0 lawyer-email" id='mapaddress'><i class="fa fa-map-marker marker-icon-css"></i>
                                        {% comment %} <a href="https://maps.google.com/maps?q=''" target="_blank" class="js-v-google-map-link map1"> {% endcomment %}
                                        {{ p.lawyer_id.address1 }}
                                        {% comment %} </a> {% endcomment %}
                                        </h3>
                                    </div>
                                </div>
                            </div>
                            <div class="col-xs-12 remove-right-gutter">
                                <div class="row lawyer-row">

                                    <div class="col-xs-12 hidden-xs hidden-sm remove-right-gutter">
                                        <div style='max-height: 83px;overflow:hidden;'>

                                        </div>
                                    </div>

                                </div>
                            </div>
                        </div>


                        <div class="col-xs-12 col-md-4 v-optimizely-card hidden-xs hidden-sm v-js-serp-lawyer-ctas">

                            <div class="row small text-center">
                                <div class="col-sm-12 u-margin-top-half">
                                    <div class="u-spacer-half"></div>
                                    {% if user.is_staff %}
                                        <a rel="nofollow" class="btn-message btn-outline-review" style='text-decoration: none;width: 94%;border-radius: 5px;' href="{% url 'lawyer_profile' p.lawyer_id.user.id %}">View Profile</a>
                                    {% else %}
                                        <a rel="nofollow" class="btn-message btn-outline-review" data-toggle="modal" data-target="#profile" data-whatever="@getbootstrap"  style='text-decoration: none;width: 94%;border-radius: 5px;' href="{% url 'lawyer_profile' p.lawyer_id.user.id %}">View Profile</a>

                                    {% endif %}
                                    </div>
                            </div>
                            <div class="row small text-center">
                                <div class="col-sm-12 u-margin-top-half">
                                {% if user.is_staff %}
                                    <div class="u-spacer-half"></div><a rel="nofollow" class="btn-review btn-outline-review" style='text-decoration: none;width: 94%;' href="{% url 'viewall_review_lawyer' p.lawyer_id.user.id %}">View All Reviews</a></div>
                                {% else %}
                                    <div class="u-spacer-half"></div><a rel="nofollow" class="btn-review btn-outline-review"  data-toggle="modal" data-target="#review" data-whatever="@getbootstrap" style='text-decoration: none;width: 94%;' href="{% url 'viewall_review_lawyer' p.lawyer_id.user.id %}">View All Reviews</a></div>

                                {% endif %}
                            </div>
                            {% if user.is_authenticated and user.is_staff %}
                            <div class="row small text-center">
                                <div class="col-sm-12 u-margin-top-half">
                                    <div class="u-spacer-half"></div><a rel="nofollow" data-id="{{ p.lawyer_id.user.id }}" class="btn-message btn-outline-review message_button" data-toggle="modal" data-target="#myModal1" data-whatever="@getbootstrap" style='background-color: #0040ff;text-decoration: none;width: 94%;border-radius: 5px;'
                                        href="">Write Message</a></div>

                            </div>
                            {% endif %}
                        </div>
                    </div>

                </div>
            </div>
            <hr/> {% endfor %}
           
            <ul class="pagination">
                {% if sub_area %}
                    {% if lawyer.has_previous %}
                        <li class="page-item"><a class="page-link" href="{% url 'filter_by_sub_area' %}?practice_area={{pname}}&sub_area={{sub_area}}&page={{ lawyer.previous_page_number }}">&laquo;</a></li>
                        {% else %}
                        <li class="page-item disabled"><span class="page-link">&laquo;</span></li>
                        {% endif %} {% for i in lawyer.paginator.page_range %} {% if lawyer.number == i %}
                        <li class="page-item active"><span class="page-link">{{ i }} <span class="sr-only">(current)</span></span>
                        </li>
                        {% else %}
                        <li class="page-item"><a class="page-link" href="{% url 'filter_by_sub_area' %}?practice_area={{pname}}&sub_area={{sub_area}}&page={{ i }}">{{ i }}</a></li>
                        {% endif %} {% endfor %} {% if data.has_next %}
                        <li class="page-item"><a class="page-link" href="{% url 'filter_by_sub_area' %}?practice_area={{pname}}&sub_area={{sub_area}}&page={{ lawyer.next_page_number }}">&raquo;</a></li>
                        {% else %}
                        <li class="page-item disabled"><span class="page-link">&raquo;</span></li>
                    {% endif %}
                {% elif experience_id %}
                    {% if lawyer.has_previous %}
                        <li class="page-item"><a class="page-link" href="{% url 'filter_by_experience' %}?practice_area={{pname}}&range={{experience_id}}&page={{ lawyer.previous_page_number }}">&laquo;</a></li>
                        {% else %}
                        <li class="page-item disabled"><span class="page-link">&laquo;</span></li>
                        {% endif %} {% for i in lawyer.paginator.page_range %} {% if lawyer.number == i %}
                        <li class="page-item active"><span class="page-link">{{ i }} <span class="sr-only">(current)</span></span>
                        </li>
                        {% else %}
                        <li class="page-item"><a class="page-link" href="{% url 'filter_by_experience' %}?practice_area={{pname}}&range={{experience_id}}&page={{ i }}">{{ i }}</a></li>
                        {% endif %} {% endfor %} {% if data.has_next %}
                        <li class="page-item"><a class="page-link" href="{% url 'filter_by_experience' %}?practice_area={{pname}}&range={{experience_id}}&page={{ lawyer.next_page_number }}">&raquo;</a></li>
                        {% else %}
                        <li class="page-item disabled"><span class="page-link">&raquo;</span></li>
                    {% endif %}
                {% elif rating %}
                    {% if lawyer.has_previous %}
                        <li class="page-item"><a class="page-link" href="{% url 'filter_by_rating' %}?practice_area={{pname}}&rating={{rating}}&page={{ lawyer.previous_page_number }}">&laquo;</a></li>
                        {% else %}
                        <li class="page-item disabled"><span class="page-link">&laquo;</span></li>
                        {% endif %} {% for i in lawyer.paginator.page_range %} {% if lawyer.number == i %}
                        <li class="page-item active"><span class="page-link">{{ i }} <span class="sr-only">(current)</span></span>
                        </li>
                        {% else %}
                        <li class="page-item"><a class="page-link" href="{% url 'filter_by_rating' %}?practice_area={{pname}}&rating={{rating}}&page={{ i }}">{{ i }}</a></li>
                        {% endif %} {% endfor %} {% if data.has_next %}
                        <li class="page-item"><a class="page-link" href="{% url 'filter_by_rating' %}?practice_area={{pname}}&rating={{rating}}&page={{ lawyer.next_page_number }}">&raquo;</a></li>
                        {% else %}
                        <li class="page-item disabled"><span class="page-link">&raquo;</span></li>
                    {% endif %}
                {% else %}           
                    {% if lawyer.has_previous %}
                        <li class="page-item"><a class="page-link" href="?practice_area={{pname}}&page={{ lawyer.previous_page_number }}">&laquo;</a></li>
                        {% else %}
                        <li class="page-item disabled"><span class="page-link">&laquo;</span></li>
                        {% endif %} {% for i in lawyer.paginator.page_range %} {% if lawyer.number == i %}
                        <li class="page-item active"><span class="page-link">{{ i }} <span class="sr-only">(current)</span></span>
                        </li>
                        {% else %}
                        <li class="page-item"><a class="page-link" href="?practice_area={{pname}}&page={{ i }}">{{ i }}</a></li>
                        {% endif %} {% endfor %} {% if data.has_next %}
                        <li class="page-item"><a class="page-link" href="?practice_area={{pname}}&page={{ lawyer.next_page_number }}">&raquo;</a></li>
                        {% else %}
                        <li class="page-item disabled"><span class="page-link">&raquo;</span></li>
                    {% endif %}
                {% endif %}
            </ul>
            {% else %}
            <div class='container' style='margin-top:3%'>
                <div class="alert alert-danger">
                    <strong>Oooop's!</strong> No Lawyers available...
                </div>
            </div>
            {% endif %}
        </div>
    </div>

    <div class="modal fade" id="myModal1" tabindex="-1" role="dialog" aria-labelledby="myModal1" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">Message {{p.lawyer_id.user.first_name}}</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
                </button>
                </div>
                <div class="modal-body">
                    <form>

                        <div class="form-group">
                            <label for="message-text" class="col-form-label">Message:</label>
                            <textarea class="form-control" id="message-text">{{p.lawyer_id.user.id}}</textarea>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary">Send message</button>
                </div>
            </div>
        </div>
    </div>

    {% include 'client/login_modal.html' %}

</div>

<!-- END -->



<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<script type="text/javascript">
</script>
<script>
    $('.message_button').click(function() {
        var user_id;
        user_id = $(this).attr("data-id");


        $.ajax({
            type: 'GET',
            url: '/send_messages/',
            data: {
                'user_id': user_id
            },
            success: function(data) {
                $('#myModal1').html(data);
            }

        })
    });
</script>


    {% comment %} <script>
        $(document).ready(function() {
            var q = encodeURIComponent($('#mapaddress').text());
            console.log(q)
            
            $('.map1').attr('href','https://www.google.com/maps?q=' + q);
            console.log( $('#map1').attr('href','https://www.google.com/maps?q=' + q))

        });
    </script> {% endcomment %}
{% endblock %}